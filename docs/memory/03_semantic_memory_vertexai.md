# Tier 2: Semantic Memory (Vertex AI Vector Search)

The Semantic Memory tier is the "long-term conceptual memory" of WEAVE. It's where we store high-dimensional vector embeddings that represent abstract concepts like user style, conversation topics, and product aesthetics. This layer allows our agents to go beyond simple keyword matching and perform searches based on *meaning* and *similarity*.

## Key Characteristics

*   **Technology:** Google Vertex AI Vector Search
*   **Purpose:** Style DNA profiling, similarity search, and semantic retrieval.
*   **Latency:** < 50ms
*   **Retention:** Persistent

## Data Stored (Vector Indices)

We maintain several vector indices within Vertex AI, each optimized for a different type of semantic search.

### 1. `style_dna` Index
This is the most critical index, containing the "style fingerprint" for every user.
*   **Vector:** A 512-dimensional floating-point array generated by the Style DNA Agent.
*   **ID:** `{user_id}`
*   **Metadata:**
    *   `fit`: "slim", "regular"
    *   `colors`: ["blue", "white", "earth_tones"]
    *   `brands`: ["brand_a", "brand_c"]
    *   `price_range`: "mid-tier"
*   **Use Case:**
    *   Finding products that match a user's style vector.
    *   Finding other users with similar styles ("lookalike audiences") for trend analysis.

### 2. `conversation_summaries` Index
To avoid searching through millions of raw messages, we store embeddings of conversation summaries.
*   **Vector:** A 768-dimensional embedding of a Gemini-generated summary of a conversation.
*   **ID:** `{conversation_id}`
*   **Metadata:**
    *   `user_id`
    *   `summary_text`: "User was asking about wedding kurtas for a sangeet in December."
    *   `conversation_date`
*   **Use Case:** When a user asks, "What did we talk about last week?", we can embed that query and find the most semantically similar conversation summary, instantly retrieving the context.

### 3. `product_embeddings` Index
This index powers our visual and stylistic search capabilities.
*   **Vector:** An embedding generated from a product's image and textual description.
*   **ID:** `{product_id}`
*   **Metadata:**
    *   `category`: "ethnic_wear"
    *   `style`: "contemporary"
    *   `price`
*   **Use Case:** When a user uploads an image, we embed it and search this index to find the most visually similar products in our catalog.

## Role in the System

1.  **Hyper-Personalization:** The `style_dna` index is the engine of our personalization. It allows the Discovery Agent to recommend products based on a deep, nuanced understanding of a user's taste, not just their last search query.
2.  **Efficient Context Retrieval:** The `conversation_summaries` index enables the Memory Manager to quickly find relevant past interactions without needing to re-process and re-read entire conversation histories, which would be slow and expensive.
3.  **Multimodal Search:** The `product_embeddings` index is what makes our "shop the look" feature possible, bridging the gap between visual inspiration and a purchasable product.

By using a dedicated vector database, we enable powerful new forms of intelligent search and retrieval that are simply not possible with traditional databases, forming the core of WEAVE's long-term "understanding."
